$klasor = "C:\Senin\Klasor\Yolu"
$listeDosyasi = "liste.txt"
$eslesmeyenDosya = "eslesmeyenler.txt"
$regex = '\b[\w$]+\.(?:"?[\w$]+"?)\b'

# Önceki çıktı dosyalarını temizle
Remove-Item $listeDosyasi, $eslesmeyenDosya -ErrorAction SilentlyContinue

$dosyalar = Get-ChildItem -Path $klasor -Recurse -Filter *.prc
$bulunan = 0

foreach ($dosya in $dosyalar) {
    $satir = Get-Content $dosya.FullName -TotalCount 1
    if ($satir -match $regex) {
        $isim = $Matches[0] -replace '"', ''  # çift tırnak varsa kaldır
        Add-Content -Path $listeDosyasi -Value $isim
        $bulunan++
    } else {
        Add-Content -Path $eslesmeyenDosya -Value $dosya.FullName
    }
}

Write-Host "Toplam .PRC dosyası: $($dosyalar.Count)"
Write-Host "Eşleşen prosedür ismi bulunan: $bulunan"
Write-Host "Eşleşemeyen dosya sayısı: $($dosyalar.Count - $bulunan)"
