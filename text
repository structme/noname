$klasor = "C:\Senin\Klasor\Yolu"
$outfile = "liste.txt"
$regex = "\b[\w$]+\.[\w$]+\b"

$dosyalar = Get-ChildItem -Path $klasor -Recurse -Filter *.prc
$bulunan = 0
$toplam = $dosyalar.Count

foreach ($dosya in $dosyalar) {
    $satir = Get-Content $dosya.FullName -TotalCount 1
    if ($satir -match $regex) {
        Add-Content -Path $outfile -Value $Matches[0]
        $bulunan++
    }
}

Write-Host "Toplam .PRC dosyası: $toplam"
Write-Host "İçinden eşleşme bulunan: $bulunan"
Write-Host "Eşleşmeyen dosya sayısı: $(($toplam - $bulunan))"
