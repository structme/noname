$klasor = "C:\yol"

Get-ChildItem -Recurse -Filter *.prc -Path $klasor | ForEach-Object { 
    $line = Get-Content $_.FullName -TotalCount 1
    
    if ($line -match "\b[\w]+\.[\w]+\b") {
        # Bulunan ismi büyük harfe çevir
        $yeniIsim = $matches[0].ToUpper()
        
        # Dosya uzantısını koru
        $uzanti = $_.Extension
        
        # Yeni dosya yolunu oluştur
        $yeniYol = Join-Path $_.Directory.FullName "$yeniIsim$uzanti"
        
        # Dosyayı yeniden adlandır
        try {
            Rename-Item -Path $_.FullName -NewName "$yeniIsim$uzanti" -ErrorAction Stop
            Write-Host "Başarılı: $($_.Name) -> $yeniIsim$uzanti" -ForegroundColor Green
        }
        catch {
            Write-Host "Hata: $($_.Name) yeniden adlandırılamadı - $($_.Exception.Message)" -ForegroundColor Red
        }
    }
    else {
        Write-Host "Uygun isim bulunamadı: $($_.Name)" -ForegroundColor Yellow
    }
}
